<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Tool Nhá»“i User áº¢o</title>
    <style>
        body { font-family: sans-serif; padding: 40px; max-width: 600px; margin: 0 auto; line-height: 1.6; }
        button { padding: 15px 30px; font-size: 1.2rem; background: #2563eb; color: white; border: none; border-radius: 8px; cursor: pointer; }
        button:hover { background: #1d4ed8; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        #logs { margin-top: 20px; background: #f1f5f9; padding: 20px; border-radius: 8px; height: 300px; overflow-y: auto; border: 1px solid #cbd5e1; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>

    <h1>ğŸ› ï¸ Tool Nhá»“i 10 User Test</h1>
    <p>Báº¥m nÃºt dÆ°á»›i Ä‘á»ƒ táº¡o tá»± Ä‘á»™ng 10 user vá»›i Ä‘á»§ loáº¡i quyá»n (Admin, Mod, User, Author, Trans) vÃ o Database.</p>
    
    <button id="btn-seed">ğŸš€ Báº¯t Ä‘áº§u bÆ¡m dá»¯ liá»‡u</button>

    <div id="logs">Chá» lá»‡nh...</div>

    <script type="module">
        // Import trá»±c tiáº¿p tá»« Config vÃ  Firestore (KhÃ´ng qua db-service Ä‘á»ƒ trÃ¡nh phá»¥ thuá»™c)
        import { db } from './js/firebase-config.js';
        import { collection, doc, setDoc } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js";

        // Danh sÃ¡ch 10 User máº«u (Äá»§ role Ä‘á»ƒ test mÃ u Badge)
        const FAKE_USERS = [
            { name: "Nguyá»…n VÄƒn A", email: "nguyena@test.com", role: "Admin" },
            { name: "Tráº§n Thá»‹ B", email: "tranb@test.com", role: "Mod" },
            { name: "LÃª VÄƒn C", email: "lec@test.com", role: "User" },
            { name: "Pháº¡m VÄƒn D", email: "phamd@test.com", role: "User" },
            { name: "HoÃ ng Thá»‹ E", email: "hoange@test.com", role: "Author" }, // Test role má»›i
            { name: "Äáº·ng VÄƒn F", email: "dangf@test.com", role: "Translator" }, // Test role má»›i
            { name: "VÅ© Thá»‹ G", email: "vug@test.com", role: "User" },
            { name: "BÃ¹i VÄƒn H", email: "buih@test.com", role: "Mod" },
            { name: "Äá»— Thá»‹ I", email: "doi@test.com", role: "Author" },
            { name: "Há»“ VÄƒn K", email: "hok@test.com", role: "User" }
        ];

        const btn = document.getElementById('btn-seed');
        const logs = document.getElementById('logs');

        function log(msg, type = 'info') {
            const div = document.createElement('div');
            div.innerText = msg;
            if (type === 'success') div.className = 'success';
            if (type === 'error') div.className = 'error';
            logs.appendChild(div);
            logs.scrollTop = logs.scrollHeight;
        }

        btn.addEventListener('click', async () => {
            btn.disabled = true;
            logs.innerHTML = '';
            log("Äang khá»Ÿi Ä‘á»™ng...");

            let count = 0;

            for (const u of FAKE_USERS) {
                try {
                    // Táº¡o ID giáº£ (nhÆ°ng cá»‘ Ä‘á»‹nh Ä‘á»ƒ dá»… quáº£n lÃ½)
                    const fakeId = `fake_user_${Date.now()}_${count}`;
                    
                    const userData = {
                        id: fakeId,
                        username: u.name,
                        email: u.email,
                        role: u.role, // Quan trá»ng: Viáº¿t hoa Ä‘Ãºng chuáº©n
                        avatar: `https://i.pravatar.cc/150?u=${fakeId}`, // Láº¥y avatar ngáº«u nhiÃªn trÃªn máº¡ng
                        likedNovelIds: [],
                        createdAt: new Date().toISOString()
                    };

                    // LÆ°u vÃ o Firestore
                    await setDoc(doc(db, "users", fakeId), userData);
                    
                    log(`âœ… ÄÃ£ táº¡o: ${u.name} (${u.role})`, 'success');
                    count++;

                } catch (e) {
                    console.error(e);
                    log(`âŒ Lá»—i táº¡o ${u.name}: ${e.message}`, 'error');
                }
            }

            log(`--- HOÃ€N Táº¤T! ÄÃ£ thÃªm ${count} user. ---`);
            log(`ğŸ‘‰ Giá» hÃ£y vÃ o láº¡i trang Profile (Tab Quáº£n trá»‹) Ä‘á»ƒ kiá»ƒm tra.`);
            btn.disabled = false;
        });
    </script>
</body>
</html>