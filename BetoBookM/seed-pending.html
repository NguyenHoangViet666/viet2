<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Tool B∆°m Truy·ªán Ch·ªù Duy·ªát</title>
    <style>
        body { font-family: sans-serif; padding: 40px; max-width: 800px; margin: 0 auto; background: #fff7ed; }
        .container { background: #fff; padding: 30px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border: 2px solid #f97316; }
        h1 { color: #f97316; margin-bottom: 10px; }
        button { padding: 15px 30px; font-size: 1.1rem; background: #f97316; color: white; border: none; border-radius: 8px; font-weight: bold; width: 100%; transition: 0.2s; margin-top: 20px; }
        button:hover { background: #ea580c; }
        #logs { margin-top: 20px; background: #262626; color: #fdba74; padding: 20px; border-radius: 8px; height: 300px; overflow-y: auto; font-family: monospace; }
        .error { color: #f87171; }
    </style>
</head>
<body>

    <div class="container">
        <h1>‚è≥ Tool B∆°m 10 Truy·ªán Ch·ªù Duy·ªát</h1>
        <p>Tool n√†y s·∫Ω t·∫°o 10 truy·ªán m·ªõi v√† y√™u c·∫ßu Admin duy·ªát.</p>
        
        <button id="btn-seed">üöÄ B·∫ÆT ƒê·∫¶U B∆†M (Status: Pending)</button>

        <div id="logs">Ready.</div>
    </div>

    <script type="module">
        import { db } from './js/firebase-config.js';
        import { collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js";

        // DANH S√ÅCH 10 TRUY·ªÜN M·∫™U (B·ªãa ra)
        const PENDING_NOVELS = [
            { title: "Ki·∫øm Kh√°ch V√¥ Danh", author: "L√£o Ti√™n Sinh", description: "H√†nh tr√¨nh b√°i s∆∞ h·ªçc ƒë·∫°o ki·∫øm thu·∫≠t...", genres: ["Ki·∫øm Hi·ªáp", "C·ªï Trang"], coverUrl: "https://via.placeholder.com/300x450/4f46e5/fff?text=Ki·∫øm+Hi·ªáp" },
            { title: "H·ª£p ƒê·ªìng V·ªõi Ma N·ªØ", author: "Phong Tr·∫ßn", description: "M·ªôt h·ª£p ƒë·ªìng ƒë·ªãnh m·ªánh ƒë·ªïi linh h·ªìn l·∫•y s·ª©c m·∫°nh t·∫°i th√†nh ph·ªë New York.", genres: ["ƒê√¥ Th·ªã", "Huy·ªÅn Huy·ªÖn"], coverUrl: "https://via.placeholder.com/300x450/1e293b/fff?text=Urban+Fantasy" },
            { title: "Tu Ti√™n Online 24/7", author: "Coder D·∫°o", description: "B·ªã √©p ph·∫£i ƒëƒÉng nh·∫≠p v√†o game tu ti√™n ƒë·ªÉ ch·ªØa b·ªánh, main ph√°t hi·ªán m√¨nh c√†y c·∫•p c√≤n nhanh h∆°n ƒëi l√†m.", genres: ["V√µng Du", "H·ªá Th·ªëng"], coverUrl: "https://via.placeholder.com/300x450/be185d/fff?text=Game+Online" },
            { title: "Ho√†ng H·∫≠u Chuy·ªÉn Sinh", author: "M·ªôc Lan", description: "N√†ng b·ªã oan khu·∫•t ·ªü ki·∫øp tr∆∞·ªõc, ki·∫øp n√†y t√°i sinh l√†m thi√™n kim nh√† gi√†u ƒë·ªÉ tr·∫£ th√π...", genres: ["Ng√¥n T√¨nh", "Tr·ªçng Sinh"], coverUrl: "https://via.placeholder.com/300x450/fb7185/fff?text=Romance" },
            { title: "K·ª∑ Nguy√™n Zombie", author: "C·ªë Ch·∫•p", description: "Th·∫ø gi·ªõi ch√¨m trong ƒë·∫°i d·ªãch, main ph·∫£i t√¨m c√°ch sinh t·ªìn b·∫±ng m·ªôt chi·∫øc r√¨u c√πn v√† chi·∫øc balo r√°ch.", genres: ["M·∫°t Th·∫ø", "Kinh D·ªã"], coverUrl: "https://via.placeholder.com/300x450/4b5563/fff?text=Apocalypse" },
            { title: "Ph·∫ø V·∫≠t H·ªçc Vi·ªán", author: "Thi·∫øu Ni√™n", description: "Tr∆∞·ªùng h·ªçc ch·ªâ d√†nh cho nh·ªØng ng∆∞·ªùi c√≥ nƒÉng l·ª±c ƒë·∫∑c bi·ªát, nh∆∞ng main l·∫°i l√† ph·∫ø v·∫≠t duy nh·∫•t.", genres: ["H·ªçc ƒê∆∞·ªùng", "H√†nh ƒê·ªông"], coverUrl: "https://via.placeholder.com/300x450/f9f9f9/333?text=School+Life" },
            { title: "ƒê·∫°i Ph·∫£n Di·ªán", author: "V√¥ Th∆∞·ªùng", description: "S·ªëng l·∫°i l√†m k·∫ª ph·∫£n di·ªán, nh∆∞ng quy·∫øt t√¢m kh√¥ng ƒë·ªÉ b·ªã main ch√≠nh h√†nh h·∫° nh∆∞ ki·∫øp tr∆∞·ªõc.", genres: ["Xuy√™n Kh√¥ng", "H·ªá Th·ªëng"], coverUrl: "https://via.placeholder.com/300x450/1f2937/fff?text=Villain" },
            { title: "Linh Kh√≠ Kh√¥i Ph·ª•c", author: "ƒê√¥ng Ph∆∞∆°ng", description: "Linh kh√≠ to√†n c·∫ßu h·ªìi ph·ª•c, con ng∆∞·ªùi b∆∞·ªõc v√†o th·ªùi ƒë·∫°i tu luy·ªán m·ªõi ƒë·∫ßy h·ªón lo·∫°n.", genres: ["Huy·ªÅn Huy·ªÖn", "ƒê√¥ Th·ªã"], coverUrl: "https://via.placeholder.com/300x450/111827/fff?text=Linh+Kh√≠" },
            { title: "M√πa H√® NƒÉm ·∫§y", author: "Anh Th∆∞", description: "M·ªôt c√¢u chuy·ªán ng√¥n t√¨nh h·ªçc ƒë∆∞·ªùng nh·∫π nh√†ng, trong tr·∫ªo v·ªÅ m·ªëi t√¨nh ƒë·∫ßu.", genres: ["Ng√¥n T√¨nh", "Thanh Xu√¢n"], coverUrl: "https://via.placeholder.com/300x450/a5f3fc/0e7490?text=Thanh+Xu√¢n" },
            { title: "H√†nh Tinh Ma Qu√°i", author: "Nh·∫≠t Th·∫ßn", description: "M·ªôt nh√≥m phi h√†nh gia kh√°m ph√° ra m·ªôt h√†nh tinh l·∫°, n∆°i c√°c ƒë·ªãnh lu·∫≠t v·∫≠t l√Ω kh√¥ng c√≤n ƒë√∫ng n·ªØa.", genres: ["Khoa Huy·ªÖn", "Phi√™u L∆∞u"], coverUrl: "https://via.placeholder.com/300x450/06b6d4/fff?text=Sci-Fi" }
        ];

        const btn = document.getElementById('btn-seed');
        const logs = document.getElementById('logs');

        function log(msg, type = 'info') {
            const div = document.createElement('div');
            div.innerText = `> ${msg}`;
            if (type === 'error') div.className = 'error';
            logs.appendChild(div);
            logs.scrollTop = logs.scrollHeight;
        }

        btn.addEventListener('click', async () => {
            btn.disabled = true;
            logs.innerHTML = '';
            log("ƒêang qu√©t User & B∆°m truy·ªán ch·ªù duy·ªát...");

            try {
                // 1. L·∫•y danh s√°ch User ID
                const usersSnap = await getDocs(collection(db, "users"));
                const userIds = usersSnap.docs.map(doc => doc.id);
                
                if (userIds.length === 0) {
                    log("‚ùå L·ªói: Kh√¥ng t√¨m th·∫•y User n√†o! H√£y ch·∫°y tool seed-users.html tr∆∞·ªõc.", 'error');
                    btn.disabled = false;
                    return;
                }

                log(`‚úÖ T√¨m th·∫•y ${userIds.length} User. B·∫Øt ƒë·∫ßu b∆°m...`);
                let count = 0;

                for (const novel of PENDING_NOVELS) {
                    const randomUid = userIds[Math.floor(Math.random() * userIds.length)];

                    const novelData = {
                        ...novel,
                        type: "Truy·ªán S√°ng T√°c",
                        uploaderId: randomUid,   
                        isPending: true, // QUAN TR·ªåNG: C·∫ßn Admin duy·ªát
                        isFeatured: false,
                        viewCount: 0,
                        createdAt: new Date().toISOString()
                    };

                    await addDoc(collection(db, "novels"), novelData);
                    log(`üìù ƒê√£ t·∫°o: "${novel.title}"`);
                    count++;
                }

                log(`--- HO√ÄN T·∫§T! ƒê√£ th√™m ${count} truy·ªán ch·ªù duy·ªát. ---`);
                log(`üëâ V√†o trang Profile Admin -> Duy·ªát b√†i ƒë·ªÉ ki·ªÉm tra.`);

            } catch (e) {
                console.error(e);
                log(`‚ùå L·ªói nghi√™m tr·ªçng: ${e.message}`, 'error');
            } finally {
                btn.disabled = false;
            }
        });
    </script>
</body>
</html>